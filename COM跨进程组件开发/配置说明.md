# 使用说明

## [项目来源](https://zhuanlan.zhihu.com/p/127357940)

## 属性配置

1. 将`Project`和`PS`的`链接器-常规-逐用户重定向`改为是，如果生成时候注册失败，则将注册改为否
2. PS：`属性-生成事件-生成前时间`，`dll.c`改为实际的地址（通常是`../dllmain.c` or `../ATLProject/dllmain.c`）
3. PS：`链接器-输入-模块定义文件`，改为`PS.def`的实际位置（可能是`../PS.def` or `../ATLProject/PS.def`）
4. 以上文件对应的实际位置如果找不到，可以在文件夹中进行搜索，通常可以找到
5. 文件路径采用相对路径（VS）

## 生成说明

1. 按照顺序生成`Project`，`ProjectPS`，`Application`
   1. `Project`是外部进程的整体框架
   2. `PS`会生成一个`dll`，对`Project`的`exe`进行注册
   3. `Application`是控制台，用于测试是否成功调用

2. 生成时，重新生成使用的环境其实是VS的配置，而不是属性中进行设置的配置，这也是为什么有时候更改配置后仍然无法成功生成的原因
3. 该工程仅限于64 - 64, 32 - 32，跨系统调用会失败，无法返回正确的组件